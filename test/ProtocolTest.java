import fr.main.sniffer.reader.InitListener;
import fr.main.sniffer.reader.InputReader;
import fr.main.sniffer.reader.Protocol;
import fr.main.sniffer.reader.Protocol2;
import fr.main.sniffer.reader.utils.DofusDataReader;
import fr.main.sniffer.tools.protocol.Message;
import org.junit.Before;
import org.junit.Test;

import java.io.ByteArrayInputStream;
import java.io.IOException;
import java.util.List;

import static org.junit.Assert.*;

public class ProtocolTest {

    @Before
    public void init() throws IOException, InterruptedException {
        InitListener.generateProtocol();
    }

    @Test
    public void testGetMessageId(){
        Protocol2 protocol = new Protocol2();
        Message message = protocol.getMessage(6312);
        assertNotNull(message);
        assertEquals("GameActionFightLifePointsLostMessage",message.getName());
    }

    @Test
    public void testGetParents() throws Exception {
        Protocol2 protocol = new Protocol2();
        Message message = protocol.getMessage(6310);
        List<Message> list = protocol.getParents(message);
        assertEquals(2,list.size());
        for(Message s : list){
            System.out.println(s.getName());
        }
    }

    @Test
    public void testGetParents2() throws Exception {
        Protocol2 protocol = new Protocol2();
        Message message = protocol.getMessage("ZaapListMessage");
        List<Message> list = protocol.getParents(message);
        assertEquals(1,list.size());
        assertEquals("TeleportDestinationsListMessage",list.get(0).getName());
        for(Message s : list){
            System.out.println(s.getName());
        }
    }

    @Test
    public void testDeserializeNoParents() throws Exception {
        byte [] data = InputReader.toByteArray("000007390000073F");
        DofusDataReader reader = new DofusDataReader(new ByteArrayInputStream(data));
        Protocol2 protocol = new Protocol2(reader);
        Message message = protocol.getMessage("ProtocolRequired");
        List<String> list = protocol.deserialize(message);
        assertEquals(2,list.size());
        for(String s : list){
            System.out.println(s);
        }
    }

    @Test
    public void testDeserializeNoParentsBBW() throws Exception {
        byte [] data = InputReader.toByteArray("0000087775626C656C3132000B5755424C454C444F555A4507737BA30000004276234EED0A80004122750000000000000000000000000001");
        DofusDataReader reader = new DofusDataReader(new ByteArrayInputStream(data));
        Protocol2 protocol = new Protocol2(reader);
        Message message = protocol.getMessage("IdentificationSuccessMessage");
        List<String> list = protocol.deserialize(message);
        assertEquals(11,list.size());
        for(String s : list){
            System.out.println(s);
        }
    }

    @Test
    public void testDeserializeParents() throws Exception {
        byte [] data = InputReader.toByteArray("000015419058200800000041A0F02C1C000000410209C0000000004191800000000000419508100400000041950814280000004194382C040000004101A11800000000419500244000000041A198181200000041A3B00C0E000000419CA0100C00000041A398002000000041A480082400000041A62804020000004195004C04000000419050000C00000041A2A014040000004196C0201000000041A6C810040000004195081C5C0000000015B401448104B601AA0116B201FF030546361E8D048E0402EA030138205F0A00158201E80292049802A403B6026EE204FA01E802C8018C01FA01A4038C0190038C01FA01B80300BE01001500000000000000000000000000000000000000000041A2400204000000");
        DofusDataReader reader = new DofusDataReader(new ByteArrayInputStream(data));
        Protocol2 protocol = new Protocol2(reader);
        Message message = protocol.getMessage("ZaapListMessage");
        List<String> list = protocol.deserialize(message);
        for(String s : list){
            System.out.println(s);
        }
        assertTrue(list.size() > 1);
        assertEquals("spawnMapId: 1.53092354E8", list.get(list.size() - 1));
    }

    @Test
    public void testDeserializeClassField() throws Exception {
        byte [] data = InputReader.toByteArray("00170005F612000200467D1100468A010DE1E9BA1F0100028735000300467D12004677100046A60301E2E9BA1F010007CA9501000600467D310046761F0046771E0046AE03030046A603030046AC0304E3E9BA1F010004F312000100467D1BE4E9BA1F010001F01200040052630408005261040800467D090046B60101E5E9BA1F010006CB9501000600467D310046761F0046771E0046AE03040046A603030046AC0303E6E9BA1F010003FC1200030046760D00467E0E00469E01C603E7E9BA1F010000F912000300467D0D0046760A00467E07E8E9BA1F01003FDF4F00570046AE06A00C0046AE06A10C0046AE06A20C0046AE06E4350046AE068D390046AE068E390046AE068F390046AE0690390046AE06D73A0046AE06853B0046AE06E43D0046AE06EE3D0046AE06F43D0046AE06F63D0046AE06F73D0046AE06893F0046AE06C73F0046AE06CB3F0046AE06CE3F0046AE06CF3F0046AE06DC3F0046AE06F3400046AE0680410046AE0689410046AE0696410046AE0697410046AE06F4410046AE06F5410046AE06F6410046AE06F7410046AE06E1420046AE06D5450046AE068B460046AE068C460046AE068F460046AE0691460046AE069F480046AE06A0480046AE06A6480046AE06A6570046AE06A7570046AE06A8570046AE06A9570046AE06AA570046AE06AB570046AE06AC570046AE06AD570046AE06965C0046AE06975C0046AE06F15D0046AE06A95E0046AE06F65E0046AE06F75E0046AE06F85E0046AE06BF600046AE06BF630046AE0695680046AE06DB6D0046AE06DC6D0046AE06DD6D0046AE06DE6D0046AE06DF6D0046AE0680710046AE0681710046AE06E0710046AE0696740046AE06D7740046AE06F5750046AE06BA760046AE06CA7A0046AE06F77C0046AE06B37E0046AE06D885010046AE06D985010046AE06928D010046AE06938D010046AE06948D010046AE06F58F010046AE06F68F010046AE06F090010046AE06F890010046AE06B092010046AE06E194010046AE06E994010046AE069096010046AE06BA98010046AE06BB9801E9E9BA1F01003FA5030000EAE9BA1F1A003F8C7C000200460A52004CD607EBE9BA1F05003FE586010000ECE9BA1F01003FC986010000EDE9BA1F01003F95780000EEE9BA1F01003FEE12000200467D1E0046AE01BE01EFE9BA1F01003FEB1200020046761800467E17F0E9BA1F01003FC935000100468B0102F1E9BA1F01003FD13F000100528B01010AF2E9BA1F01003FA60500010046DD04D00FF3E9BA1F1B003FA70500010046DD04C801F4E9BA1F40003FF6020000F5E9BA1F02003F9F770000F6E9BA1F38003FBF110000F7E9BA1F06D7FC1F");
        DofusDataReader reader = new DofusDataReader(new ByteArrayInputStream(data));
        Protocol2 protocol = new Protocol2(reader);
        Message message = protocol.getMessage("InventoryContentMessage");
        List<String> list = protocol.deserialize(message);
        for(String s : list){
            System.out.println(s);
        }
        assertTrue(list.size() > 1);
        assertTrue(list.get(list.size() - 1).contains("kamas"));
    }

    @Test
    public void testDeserializeMap() throws Exception {
        byte [] data = InputReader.toByteArray("5F41A6C81004000000000201FEC6941C8D0300010007DB0D001000000000010006736A6D747062C094DE0F0000000002000D506174726F75696C6C657572738087A70E0200000003000C7361696E74732D6C75666679000200000004000B6E6F756E6F757465626F79000200000005000B4D6F7274652D706C657572000200000006000662622D72756E0002000000070008784E616E6F437261000200000008000E73757270657264796C616E6D616E000200000009000B7468652D77696E65722D3100020000000A000648757375677500020000000B000776656E6465736500020000000C0008417265626F75726700020000000D000D4D616769737465722D6B61686E00020000000E00082D456C64756E612D00020000000F00076774323232303500020000001000066D6178706C690001FEC7941C8D0300010007DB0E00140200000001000B587842616F2D426162785800020000000200086C6564757432393000020000000300013F000200000004000C64617669646574616C696365FF93EBDC03020000000500013F000200000006001D6A69726669766A6675726A66757266757275666A7572666A6A72666A72C0F9EF0C020000000700076665726F63696B00000000000800084461796D6F6F7844000200000009000D466C656D6D652D64652D76696500020000000A0007616C6F6973656100020000000B000853686F3067616E7300020000000C000631393836353400020000000D000C6D756C676F73737175656E7400020000000E00013F00020000000F000F4361707461696E2D422D53776F7264000200000010000D4D4C4B4A484746444647484A4B00020000001100126A61696E612D6875726C6F72616765313032000200000012000C7361646973656E766F7574650002000000130006706977697A6F000200000014000A4172746969696F6F6E6E00002200244239B19500D0000001000646C310FC099B012EA90700090186787702FFFFFF030713F704FF0008054244450700000008B5001A0978050A0A00000000016E000101008C0B0000000000015A0000003C00F701000B456D6B696C6C2D4865616C009D00080000000401999F3A000E476574737567612074656E73686FC8880100B5001A150000000001A9AB0D0003534146001253616E7320416C6C69616E63652046697865DB0100000000160078050A0001984F0000019B21BC010331B88C0000004239B195018C000000244246C65E00680000800E000000040128270002F1020703ED03230400FF0000000001020002000651DB10F008DC0839DC07000701F5B95F02FFFFFF0328270004F1020705ED03230737363608F4C50F00018C010000003C00F501000A4B656E2D4B616E656B69009D0008000100030199BF2B0009486F72697A6F6E277348820100F4C50F1D003736360198A9010000019B40B8010273E83F013F004246C65E00C400000024425EF31B8034000001000633AB10EC1AD81CDB09FF04000501FFFFFF021D1D1D03FFFFFF04FFC41605FFD01600016E0000003C01D3010013417474656E74696F6E2D6C612D73796E63726F009D000800010000052AD5BF000000425EF31B8043C0000024425084D680340000841C000000040100000002000000030000000400FF00000173000102000200065BE410CC1CD81CE21CFF19000901000000020000000300000004000000050000000700000008FFE45F093F545C0AEDDB93000187010000003C010400000844616979612D5463009D00080001000301999039000753656E27506169C8890100FFE45F0F0000000001A9CD0F00034147500015416D6F757220476C6F69726520657420506F6E6579E80100EDDB9308003F545C00019B71A50204DB34D7000000425084D6806600000024423C5CBC00D0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001410000003C0170010007476F756C70696E009D0008000000040199A25B000948617265626F757267292600FFFFFF0800A4334701A9EC0F000341745200134167656E636520746F75732052697371756573D50100FFFFFF18002E646D0001986E0000019B285F075FD051000000425EE989404BC0000024425EF1A90034000001000650D010EF017737CE04000501FFCE75026A360303D6F8FF04710000056E170300018C0100010100F1010000000000013C0000003C019B00000A4576656E2D4372617A79009D00080000000006FCFB4B000000425EF1A9003B800000244256A3CBC0340000841C000000040143342102FFD93603A663090400FF00000173000102000200061E80109C17CD18DC1B971A000901F3BC5E02FFFFCE0343342104FFD93605A6630907FFC4CC08000000090102010A89DFC90001780000003C01040100095374726F7669746368009D0008000000040199BD27000C5627696C2053276D697373653F7A000000001E00FFC4CC01A9CF070005446F664652000E446F66752753204672616E27436591010089DFC9050001020100019899010000019B12E001059F487B0137004256A3CBC06600000024423CCBE400D0000001000651D610CF1CD81CE21CA01B000901FFCC6602FF990003FF660004FFB24005E573000700000008FFE45F093F545C0AEDDB9300018C0100010100CC23000000000001500000003C009207000841747375652D5463009D00080001000401999039000753656E27506169C8890100FFE45F0F0000000001A9CD0F00034147500015416D6F757220476C6F69726520657420506F6E6579E80100EDDB9308003F545C000198CB010000019B6CDE0304EBA2B8016400423CCBE4019800000024425EF0C0003400000100050ADC0FAE02BC019807000901FFD27C026C4F2D03FCB3FE04FFFFFF05FFC1FA07FFFFE60840C8BE0920C1390A040C03000187010000003C019C030009436F6F7573636F7573009D0008000000020199D25D000E6327657374206D61206D657574651B340040C8BE0100FFFFE601A9AA0F00034C534200146C6573207365636F75657320647520626F63616C2000040C03210020C139000473C443000000425EF0C0005580000024422A42E201A000000100070ADC0FA717C213F80938EB13000901FFC278029F04C40306009A0400000005612C000700008908D6C4FF09EF731E0AFBFBFF000187010000003C00CB01000748696B6172796F009D00080000000501970F42762E7A2CB640000199C31F001E4C657320737175617474657273206475205A61617020642741737472756241990100D6C4FF130000008901A9FA030005487964726500054879647265A70100FBFBFF1A00EF731E000198500000019B37EB010359B236000000422A42E203300000000400500007DB0D0000012C000200DB54030C85CA00DB61030C85CD00000100500007DEB50000013C000100DBE80202ECCC5800000100500007E00B00000010000100DB7202ECCC5900000100500007DB0E0000012C000200DB54030C865000DB61030C865300000100000000000001000CD701E501E601F201F40182028F02B702C402F60284039303000CF3018102A802B602BF02C302C502CC02D202D302DA02E002");
        DofusDataReader reader = new DofusDataReader(new ByteArrayInputStream(data));
        Protocol protocol = new Protocol();
        List<String> list =  protocol.getData(226,reader);
        for(String s : list){
            System.out.println(s);
        }
        assertTrue(list.size() > 10);
        assertTrue(list.get(list.size() - 1).contains("positionsForDefenders"));
    }


    @Test
    public void testDeserializeMap2() throws Exception {
        byte [] data = InputReader.toByteArray("5F41A6C81004000000000201FEC6941C8D0300010007DB0D001000000000010006736A6D747062C094DE0F0000000002000D506174726F75696C6C657572738087A70E0200000003000C7361696E74732D6C75666679000200000004000B6E6F756E6F757465626F79000200000005000B4D6F7274652D706C657572000200000006000662622D72756E0002000000070008784E616E6F437261000200000008000E73757270657264796C616E6D616E000200000009000B7468652D77696E65722D3100020000000A000648757375677500020000000B000776656E6465736500020000000C0008417265626F75726700020000000D000D4D616769737465722D6B61686E00020000000E00082D456C64756E612D00020000000F00076774323232303500020000001000066D6178706C690001FEC7941C8D0300010007DB0E00140200000001000B587842616F2D426162785800020000000200086C6564757432393000020000000300013F000200000004000C64617669646574616C696365FF93EBDC03020000000500013F000200000006001D6A69726669766A6675726A66757266757275666A7572666A6A72666A72C0F9EF0C020000000700076665726F63696B00000000000800084461796D6F6F7844000200000009000D466C656D6D652D64652D76696500020000000A0007616C6F6973656100020000000B000853686F3067616E7300020000000C000631393836353400020000000D000C6D756C676F73737175656E7400020000000E00013F00020000000F000F4361707461696E2D422D53776F7264000200000010000D4D4C4B4A484746444647484A4B00020000001100126A61696E612D6875726C6F72616765313032000200000012000C7361646973656E766F7574650002000000130006706977697A6F000200000014000A4172746969696F6F6E6E0000190024423F319700D00000841C0000000401FFFFFF02AF1404030400000400FF00000173000102000200065BE410CB1CBE13DC1BDC07000901FFC36702AF140403FFFFFF04AF1404050400000700000008D604090978050A0A000000000187010000003C014D0300095265642D486F6C6C79009D0008000100040199F84C000756204E6F6E6E65C87200D604091D0000000001A9AB0D0003534146001253616E7320416C6C69616E63652046697865DB0100000000160078050A0001989C010000019B3AE00104A739FD011800423F3197019800000024423A8C0B00D00000010004EB18EF189809ED1C000901FFFFFF027AA0A003A2612A04298CA905D8C89407826638084D1A1A0978050A0A0000000001910100010600AA010000000000000000003C019C0200094164616D2D656C696F009D00080000000501971642762DE375EAE0000199D54E000F4C65732062726173204361737365734D33004D1A1A160082663801A9AB0D0003534146001253616E7320416C6C69616E63652046697865DB0100000000160078050A000198A7010000019B3ECA0106ECC4E8011800423A8C0B0198000000244242A34600680000010004789011AC0D4D0009010000000200000003EDC0E00479263A0500000007FFC8760802000009C5B47F0A3435340001A00100010100C9170000000000000000003C011F03000A4A61636B69696368616E009D0008000000040199C317000A5061726127446F786961C83A000200000100FFC87601A9C902000452454E4500124C65732052656E4573206574205279756D6921003435340800C5B47F000198A0010000019B27D001034D21120200004242A34600CC00000024425EF2B4003400000100039D0BAF11B703000901FFC3670218181803181818045E5F4A05FFFFBF072A9E9508FFFFFF092E646D0AFFFFFF000196010000003C013D010006000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000247CA10000501000000023C3C3C03116D81047E956205FFFFFF0001730000003C01520100105A6775656E2D4D65646963696E616C65009D000800010002019891010000019B28D70104902745020001425EB820C06600000024425EB8200034000001000278931100050100000002494F5203F6E05D04FFFFFF051C253B0001A0010000003C014401000A5A6775656E2D49767265009D000800000002019893010000019B28CE010490247B020001425EB820006600000024425EB8204034000001000251DB100005010000000236363603F1B45A0439394605444D4D00018C010000003C012901000F5A6775656E2D436F6C657269717565009D000800010002019893010000019B28E10103F0F37E020001425EB82040660000002442583C8780340000841C0000000401BAB5790260573903423C280400FF0000017300010200020006800DC511CF1CC5019C0B991A000901E89C3F02FF990003BAB5790460573905423C2807FFFFFF08107AC8092491E60AD4F4FD0001A0010000003C00D40100084C6961647269656C009D0008000100040199A701000E4C65732044657365727465757273C85A00107AC80F00FFFFFF01A906000446495348000C446F75626C652043616E6E65930100D4F4FD0F002491E6150198B1010000019B26D301020DA93901350042583C8780660000000400500007DB0D0000012C000200DB54030C85CA00DB61030C85CD00000100500007DEB50000013C000100DBE80202ECCC5800000100500007E00B00000010000100DB7202ECCC5900000100500007DB0E0000012C000200DB54030C865000DB61030C865300000100000000000000000CD701E501E601F201F40182028F02B702C402F60284039303000CF3018102A802B602BF02C302C502CC02D202D302DA02E002");
        DofusDataReader reader = new DofusDataReader(new ByteArrayInputStream(data));
        Protocol2 protocol = new Protocol2(reader);
        Message message = protocol.getMessage("MapComplementaryInformationsDataMessage");
        List<String> list = protocol.deserialize(message);
        for(String s : list){
            System.out.println(s);
        }
        assertTrue(list.size() > 10);
        assertTrue(list.get(list.size() - 1).contains("positionsForDefenders"));
    }


}
